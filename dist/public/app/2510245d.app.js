"use strict";angular.module("youAreAFishApp",["ngCookies","ngResource","ngSanitize","ui.router","ui.bootstrap"]).config(["$stateProvider","$urlRouterProvider","$locationProvider",function(a,b,c){b.otherwise("/"),c.html5Mode(!0)}]),angular.module("youAreAFishApp").directive("fishbowl",["$compile","$interval",function(a,b){return{restrict:"A",templateUrl:"app/tpl/fishbowl-tpl.html",link:function(c,d){var e,f,g=.001,h=[],i=8,j=1024,k=570,l=j-100,m=k-80,n=50,o=io(),p=function(a){return Math.ceil(Math.random()*a)},q=function(a){return a.vx>0?a.imageFlip:a.image},r=function(){var a=p(3);this.image="/assets/images/fishes/fish_"+a+".png",this.imageFlip="/assets/images/fishes/fish_"+a+"_flipped.png",this.y=p(m),this.x=p(l),this.vx=p(g),this.vy=p(g),this.v=this.vy/this.vx,this.msg="",this.user=""},s=function(a){var b=new r;h.push({msg:b.msg,x:b.x,y:b.y,vx:b.vx,vy:b.vy,v:b.v,image:b.image,imageFlip:b.imageFlip,user:a})},t=d3.tip().attr("class","d3-tip").html(function(a){return"<p class='triangle-right'>"+a.msg+"</p>"}),u=d3.select("#fishbowl").append("svg").attr("width",j).attr("height",k);u.call(t),u.append("image").attr("xlink:href","/assets/images/4ed87418.fishtank.jpg").attr("width","100%").attr("height","100%");var v=function(){e=u.selectAll("image").data(h).enter().append("svg:image").attr("id",function(a){return a.user}).attr("xlink:href",function(a){return q(a)}).attr("x",function(a,b){return a.x}).attr("y",function(a,b){return a.y}).attr("width","10%").attr("height","10%").call(function(){a(this[0].parentNode)(c)})},w=function(){e.attr("x",function(a){return(a.x>=l||a.x<=0)&&(a.vx=-a.vx),a.x+=a.vx,a.x}).attr("y",function(a){return(a.y>=m||a.y<=0)&&(a.vy=-a.vy),a.y+=a.vy,a.y}).attr("xlink:href",function(a){return q(a)})};c.submit=function(){o.emit("chat message",c.msg),c.msg=""},c.refreshFish=function(){b.cancel(f),v(),f=b(function(a){w()},n)},c.appendFish=function(a){e.remove(),s(a),c.refreshFish()},c.removeFish=function(a){var b=!1;e.remove(),h.forEach(function(c,d){c.user!==a||b||(h.splice(d,1),b=!0)}),console.info(h),c.refreshFish()},o.on("chat message",function(a){var c=JSON.parse(a);h.forEach(function(a,d){if(a.user===c.user){h[d].msg=c.msg;{var e=h[d];b(function(){t.show(e,document.getElementById(e.user))},n)}}})}),o.on("connectme",function(a){var b=JSON.parse(a).user,d=JSON.parse(a).length;for(i=d;h.length<d+1;)c.appendFish(b)}),o.on("disconnectme",function(a){c.removeFish(a)}),f=b(function(a){w()},n),s(),v()}}}]),angular.module("youAreAFishApp").controller("MainCtrl",["$scope","$http",function(a,b){a.awesomeThings=[],b.get("/api/things").success(function(b){a.awesomeThings=b})}]),angular.module("youAreAFishApp").config(["$stateProvider",function(a){a.state("main",{url:"/",templateUrl:"app/main/main.html",controller:"MainCtrl"})}]),angular.module("youAreAFishApp").factory("Modal",["$rootScope","$modal",function(a,b){function c(c,d){var e=a.$new();return c=c||{},d=d||"modal-default",angular.extend(e,c),b.open({templateUrl:"components/modal/modal.html",windowClass:d,scope:e})}return{confirm:{"delete":function(a){return a=a||angular.noop,function(){var b,d=Array.prototype.slice.call(arguments),e=d.shift();b=c({modal:{dismissable:!0,title:"Confirm Delete",html:"<p>Are you sure you want to delete <strong>"+e+"</strong> ?</p>",buttons:[{classes:"btn-danger",text:"Delete",click:function(a){b.close(a)}},{classes:"btn-default",text:"Cancel",click:function(a){b.dismiss(a)}}]}},"modal-danger"),b.result.then(function(b){a.apply(b,d)})}}}}}]),angular.module("youAreAFishApp").controller("NavbarCtrl",["$scope","$location",function(a,b){a.menu=[{title:"Home",link:"/"}],a.isCollapsed=!0,a.isActive=function(a){return a===b.path()}}]),angular.module("youAreAFishApp").run(["$templateCache",function(a){a.put("app/main/main.html",'<div class=container><div class=normalTxt style="padding-bottom: 1%">You are a fish. Here, you can talk to other fishes in this fishtank</div><div fishbowl></div></div>'),a.put("app/tpl/fishbowl-tpl.html",'<script>document.onkeydown=function(evt){\n    var keyCode = evt ? (evt.which ? evt.which : evt.keyCode) : event.keyCode;\n    if(keyCode == 13)\n    {\n        document.getElementById("submitBtn").click();\n    }\n}</script><div id=fishbowl></div><div class=center><input id=messageBox ng-model=msg class=fishtankTxt placeholder="Communicate with other fishes" autofocus><input id=submitBtn type=button ng-click=submit() class=fishtankBtn value=Send></div>'),a.put("components/modal/modal.html",'<div class=modal-header><button ng-if=modal.dismissable type=button ng-click=$dismiss() class=close>&times;</button><h4 ng-if=modal.title ng-bind=modal.title class=modal-title></h4></div><div class=modal-body><p ng-if=modal.text ng-bind=modal.text></p><div ng-if=modal.html ng-bind-html=modal.html></div></div><div class=modal-footer><button ng-repeat="button in modal.buttons" ng-class=button.classes ng-click=button.click($event) ng-bind=button.text class=btn></button></div>'),a.put("components/navbar/navbar.html",'<div class="navbar navbar-default navbar-static-top" ng-controller=NavbarCtrl><div class=container><div class=navbar-header><button class=navbar-toggle type=button ng-click="isCollapsed = !isCollapsed"><span class=sr-only>Toggle navigation</span> <span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a href="/" class=navbar-brand>you-are-afish</a></div><div collapse=isCollapsed class="navbar-collapse collapse" id=navbar-main><ul class="nav navbar-nav"><li ng-repeat="item in menu" ng-class="{active: isActive(item.link)}"><a ng-href={{item.link}}>{{item.title}}</a></li></ul></div></div></div>')}]);